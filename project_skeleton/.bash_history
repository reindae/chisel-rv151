exit
ls
cd project_skeleton/
cd sr
cd src/
ls
vim ALU.v
exit
ls
exit
ls
cd /
ls
cd ..
cd
git clone /home/ff/eecs151/labs/project_skeleton /path/to/my/project
git clone /home/ff/eecs151/labs/project_skeleton .
git clone /home/ff/eecs151/labs/project_skeleton
cd project_skeleton/
ls
cd src/
ls
vim Memory151.v 
vim Riscv151.v
vim riscv_top.v
vim Memory151.v 
ls
cd /
ls
cd
exit
ls
exit
du -ch --max-depth=1
df -H
quota -s
ls
cd home
cd /
ls
cd home
ls
cd tmp
ls
cd eecs151-aat
cd eecs151-aae
ls
cd ..
cd eecs151-abs
cd ..
cd
ls
git config --global user.name "Darwin Zhang"
git confit --global user.name
git config --global user.name
git config --global user.gmail "dwzhang@berkeley.edu"
git config --global user.email
git config --global user.email "dwzhang@berkeley.edu"
git config --global user.email
ssh-keygen -t ed25519 -C "dwzhang@berkeley.edu"
ls -al ~/.ssh
eval "$(ssh-agent -s)"
ssh-add ~/.ssh/id_ed25519
ls -al ~/.ssh
cat ~/.ssh/id_ed25519.pub
ssh -T git@github.com
quota -s
git remote -v
cat ~/.ssh/config
/usr/bin
echo $PATH
ls -lt /usr/bin | head -n 6
quota -u eecs151-aae
quota -s eecs151-aae
quota -s eecs151-abs
quota -s eecs151-aae
ls
ls -lt /usr/bin | tail -n 5
ls -lt /usr/bin | head -n 6
ls -lt /usr/bin | tail -n 5
ls
cd
ls
cd /
ls
cd usr
cd bin
ls
cd ..
ls
cd 
ls -lt ~ | tail -n 5
ls -lt ~ | tail -n 6
which git
ls -a
vim --version
nvim -V1 -v
ping www.google.com
kill
ping www.google.com
$!
ping www.google.com $
ping www.google.com &
$$!
$!
kill
ki
du -ch --max-depth=1
$!
nvim -V1 -v
ping www.google.com
kill %1
ping www.google.com &
echo "Background process PID: $!"
kill $!
ping www.google.com
kill
top
kill
top
htop
uptime
top
cd Desktop
top
free -h
cd /home/tmp/eecs151-aae
ls
cd ..
ls
cd ..
cd
cd /home/tmp/eecs151-aae
ls
cd ..
cd
cd Desktop
git clone asic-labs-fa23-reindae
cd /home/tmp/eecs151-aae
git clone asic-labs-fa23-reindae
cd ..
cd
cd Desktop
git clone https://github.com/EECS-151/asic-labs-fa23-reindae
git clone git@github.com:EECS-151/asic-labs-fa23-reindae.git
ls
cd asic-labs-fa23-reindae/
ls
cd lab1
ls
vim force_regs.ucli
grep "unit_cell_[0-9]\{1\}\." force_regs.ucli
sed -e 's/\(unit_cell_\)\([0-9]\{1\}\.\)/\10\2/' force_regs.ucli
sed -r -e 's/(unit_cell_)([0-9]{1}\.)/\10\2/' force_regs.ucli
grep -E "unit_cell_[0-9]{1}\." force_regs.ucli
find . | grep ".ucli"
sed -e '/reset/d' force_regs.ucli
sed -e 's/\(unit_cell_\)\([0-9]\{1\}\.\)/\10\2/' force_regs.ucli > force_regs.ucli.zeropadded
ls
sed 's/([0-9]+)x([0-9]+)/<\1><\2>/g' force_regs.ucli
sed -E 's/([0-9]+)x([0-9]+)/<\1><\2>/g' force_regs.ucli
cat force_regs.ucli
ls
vim force_regs.ucli
sed -E 's/([0-9]+)x([0-9]+)/<\1><\2>/g'
sed -e 's/([0-9]+)x([0-9]+)/<\1><\2>/g' force_regs.ucli
sed -e 's/\(unit_cell_\)\([0-9]\{1\}\.\)/\10\2/' force_regs.ucli
ls
sed -e 's/([0-9]+)x([0-9]+)/<\1><\2>/g' force_regs.ucli
sed -e 's/\(unit_cell_\)\([0-9]\{1\}\.\)/\10\2/' force_regs.ucli
ls
cd Desktop/
ls
cd asic-labs-fa23-reindae/
cd lab1/
ls
sed -E 's/([0-9]+)x([0-9]+)/<\1><\2>/g' force_regs.ucli
grep "unit_cell_[0-9]\{1\}\." force_regs.ucli
sed -e 's/\(unit_cell_\)\([0-9]\{1\}\.\)/\10\2/' force_regs.ucli
grep "reg" force_regs.ucli
grep "regx\d+x" force_regs.ucli
grep "regx" force_regs.ucli
grep "regx(\d)" force_regs.ucli
grep "regx\d" force_regs.ucli
grep "regx[0-9]" force_regs.ucli
grep "regx[0-9]+" force_regs.ucli
grep "regx[0-9]*" force_regs.ucli
grep "regx[0-9]*x?" force_regs.ucli
grep "regx[0-9]*x+" force_regs.ucli
grep "regx[0-9]*x" force_regs.ucli
grep "reg(x[0-9]*x)+" force_regs.ucli
grep "reg(x[0-9]*x)*" force_regs.ucli
grep "reg(x[0-9]*x)" force_regs.ucli
grep "regx[0-9]*x" force_regs.ucli
grep "reg\(x[0-9]*x)" force_regs.ucli
grep "reg/(x[0-9]*x)" force_regs.ucli
grep "reg/(x[0-9]*x)*" force_regs.ucli
grep "reg/(x[0-9]*x)" force_regs.ucli
grep "reg(x[0-9]*x)." force_regs.ucli
grep "regx\d+(?:\d+x)*\d+x" force_regs.ucli
grep "reg(?:x[0-9]*x)." force_regs.ucli
grep "regx[0-9]*x" force_regs.ucli
grep "reg(x[0-9]*x)" force_regs.ucli
grep "reg(x[0-9]* x)" force_regs.ucli
grep "regx\d*x" force_regs.ucli
grep "regx[0-9]*x" force_regs.ucli
grep "regx[0-9]*xx[0-9]*x" force_regs.ucli
grep "reg(x[0-9]*x)*" force_regs.ucli
grep "reg(x[0-9]*x)" force_regs.ucli
grep "reg(?:x[0-9]*x)" force_regs.ucli
grep "reg(x[0-9]*x)+" force_regs.ucli
grep "regx[0-9]+x" force_regs.ucli
grep "regx[0-9]*x" force_regs.ucli
grep "regx[0-9]*x(x[0-9]*x)?" force_regs.ucli
grep "regx[0-9]x" force_regs.ucli
grep "regx[0-9]+x" force_regs.ucli
grep "regx[0-9]+" force_regs.ucli
grep "regx[0-9]*+" force_regs.ucli
grep "regx[0-9]?x" force_regs.ucli
grep "regx[0-9]*x" force_regs.ucli
sed -e 's/\(unit_cell_\)\([0-9]\{1\}\.\)/\10\2/' force_regs.ucli
grep -E "unit_cell_[0-9]{1}\." force_regs.ucli
grep "reg\(x[0-9]*x\)" force_regs.ucli
grep "reg\(x[0-9]*x\)*" force_regs.ucli
grep "reg\(x[0-9]*x\)+" force_regs.ucli
grep "reg\(x[0-9]*x\)*" force_regs.ucli
grep "\(x[0-9]*x\)*" force_regs.ucli
grep "\(x[0-9]*x\)+" force_regs.ucli
grep "\(x[0-9]*x\)*" force_regs.ucli
sed -e 's/x\([0-9]*\)x/<\1>/' force_regs.ucli > force_regs.ucli.test
ls
vim force_regs.ucli.test
sed -e 's/x\([0-9]*\)x*/<\1>/' force_regs.ucli > force_regs.ucli.test
vim force_regs.ucli.test
sed -r -e 's/(x\([0-9]*)x/<\1>/\)*' force_regs.ucli > force_regs.ucli.test
sed -e 's/x\([0-9]*\)x/<\1>/g' force_regs.ucli > force_regs.ucli.test
vim force_regs.ucli.test
sed -r -e 's/x([0-9]*)x/<\1>/g' force_regs.ucli > force_regs.ucli.test2
vim force_regs.ucli.test2
sed -r -e 's/x([0-9]*)x/<\1>/g' force_regs.ucli
cd ..
cd Desktop/asic-labs-fa23-reindae/
cd lab1
ls
vim Makefile
$ls -l /home/amrood
ls -l /home/amrood
ls -l /home
cd Desktop/asic-labs-fa23-reindae/lab1
ls
cat runalways.sh
chmod u+x runalways.sh
cat runalways.sh
chmod go-x runalways.sh
cat runalways.sh
chmod u+x go-x runalways.sh
ls -l
chmod go+x runalways.sh
ls -l
chmod go-x runalways.sh
ls -l
chmod go+r runalways.sh
ls -l
chmod go-r runalways.sh
ls -l
chmod go-x runalways.sh chmod u+x runalways.sh
chmod g+x runalways.sh
ls -l
chmod ug+w your_script.sh
chmod ug+w runalways.sh
chmod o-r runalways.sh
ls -l
sudo chown eecs151 your_file
ls
cat Makefile
make
cat force_regs.random.ucli 
sed -r -e 's/x([0-9]*)x/<\1>/g' force_regs.ucli
cat Makefile
cat force_regs.random.ucli
make
vim Makefile
make
vim Makefile
make
ls
vim Mkafile
vim Makefile
make
vim Makefile
make
make foo.txt
ls
cat foo.txt
make
vim Makefile
make
cat force_regs.random.ucli
vim Makefile
make
ls
rm foo.txt
ls
make
ls
make
ls
vim Makefile
make
ls
make
vim Makefile
make
ls
vim Makefile
make
ls
vim Makefile
ls
make
ls
vim Makefile
make
ls
make foo.txt
vim Makefile
make foo.txt
ls
make
ls
vim Makefile
make
make -B
ls
vim Makefile
make foo.txt
ls
vim Makefile
make -B
ls
vim Makefile
make -B
ls
vim Makefile
make foo.txt
vim Makefile
ls
rm foo.txt
ls
make
ls
make -B
ls
cat foo.txt
vim Makefile
rm foo.txt
ls
make
make -B
ls
vim Makefile
make -B
ls
vim Makefile
make -B
ls
vim Makefile
make -B
ls
vim Make
ls
cat Make
rm Make
vim Makefile
make
make -B
ls
make all
ls
vim Makefile
make -B
ls
make all
ls
rm foo.txt
vim Makefile
ls
make
ls
make -B
ls
vim Makefile
make
ls
rm foo.txt
ls
make
ls
make
rm foo.txt
ls
make
ls
vim Makefile
rm foo.txt
make
ls
vim Makefile
rm foo.txt
make
ls
make
rm foo.txt
vim Makefile
ls
make
ls
make
make -B
ls
vim Makefile
make
ls
vim Makefile
make
vim Makefile
ls
cd Desktop/asic-labs-fa23-reindae/lab1/
ls
rm foo.txt
make
vim Makefile
make
vim Makefile
ls
make
ls
cat foo.txt
git diff HEAD~1 -- path/to/Makefile
git diff HEAD -- path/to/Makefile
git status
chmod u+x, go-x runalways.sh
chmod u+x runalways.sh
git diff
chmod ug+x o-r  runalways.sh
chmod ug+x,o-r runalways.sh
ls -l
chmod ug+x,o+r runalways.sh
ls -l
chmod ug+x,o-r runalways.sh
ls -l
ls -a
ls -a /Desktop
which git
ls -lt /usr/bin | tail -n 5
ls -lt /usr/bin | head -n 6
ls -lt /usr/bin | head -n 5
ls -a
ls -a ~/Desktop
ls -a ~/Desktop/asic-labs-fa23-reindae/lab1
git diff HEAD Makefile
git diff --stage Makefile
vim Makefile
nvim
cd Desktop/asic-labs-fa23-reindae/
cd lab1/
ls
vim Makefile
cd ~/.vimrc
cd ~/.config/nvim
ls
cd ..
cd Desktop/asic-labs-fa23-reindae/lab1/
ls
sed -e 's/x\([0-9]*\)x/<\1>/g' force_regs.ucli
sed -e 's/x\([0-9]+\)x/<\1>/g' force_regs.ucli
sed -e 's/x\([0-9]+\)x/<\2>/g' force_regs.ucli
sed -r -e 's/x\([0-9]+\)x/<\1>/g' force_regs.ucli
sed -e 's/x\([0-9]+\)x/<\1>/g' force_regs.ucli
sed -e 's/x\(\d)x/<\1>/g' force_regs.ucli
sed -e 's/x\(\\d)x/<\1>/g' force_regs.ucli
sed -e 's/x\([0-9]+\)x/<\1>/g' force_regs.ucli
sed -e 's/x\([0-9]*\)x/<\1>/g' force_regs.ucli
sed -r -e 's/x([0-9]*)x/<\1>/g' force_regs.ucli
sed -r -e 's/x([0-9]+)x/<\1>/g' force_regs.ucli
sed -e 's/x\([0-9]*\)x/<\1>/g' force_regs.ucli
sed -e 's/x\([0-9]\)x/<\1>/g' force_regs.ucli
sed -e 's/x\([0-9]+\)x/<\1>/g' force_regs.ucli
sed -e 's/x\([0-9]\+\)x/<\1>/g' force_regs.ucli
ping www.google.com
kill
ping www.google.com &
$!
$$!!
$!
$
!
kilkill
kill
kill $!
ping www.google.com > /dev/null &
ps

ping www.google.com > /dev/null &
ps
kill $!
ps
kill $!
kill
$!
kill -9 $!
kill 3818176 $!
kill 3818176
kill 3804940
ps
kill $!
kill ping
kill 3804940
ps
kill -9
ps
kill -9 $!
kill 3804940 $!
kill 3804940
kill 3804940
kill ping
kill 3818176
kill 3804940
kill -9 3804940
ps
exit
~/.vimrc
:source ~/.vimrc
vim
cd ~/.vimrc
cd .vimrc
ls
cd /
ls
cd ~/.vimrc
cd
ls
ls -a
cd .vimrc
vim
cd Desktop/asic-labs-fa23-reindae/lab1/
vim Makefile
~/.vimrc
cd ../..
cd ..
ls
cd ~/.config
ls
cd nvim
ls
init.vim
vim init.vim
vim
ls
ls -a
cd ..
ls
cd ..
vim
vim --version
nvim -V1 -v
vim
which vim
which innovus
which vim
echo $PATH
source /home/ff/eecs151/asic/eecs151.bashrc
echo $PATH
which innovus
duc -ch --max-depth=1
du -ch --max-depth=1
df -H
quota -s
vim
vim
cd ~/.config/nvim
ls
open init.vim
open lazy-lock.json
vim
rm -rf ~/.local/share/nvim
vim
exit
rm -rf ~/.local/share/nvim
vim
rm -rf ~/.local/share/nvim
vim
cd Desktop/asic-labs-fa23-reindae/lab1/
ls
vim Makefile
rm -rf ~/.local/share/nvim
vim Makefile 
cd Desktop/
cd asic-labs-fa23-reindae/
git remote -v
git status
git add .
git commit -m "lab 1"
git push
cd lab1
sed -e 's/x\([0-9]\+\)x/<\1>/g' force_regs.ucli
sed -e 's/x\(\d\+\)x/<\1>/g' force_regs.ucli
sed -e 's/x\([0-9]\+\)x/<\1>/g' force_regs.ucli
rm -rf ~/.local/share/nvim
cd Desktop/asic-labs-fa23-reindae/lab1/
vim Makefile
vim
rm -rf ~/.local/share/nvim
nvim
vi
exit
vim
rm -rf ~/.local/share/nvim
vim
ls
exit
rm -rf ~/.local/share/nvim
vim
nvim
exit
source /home/ff/eecs151/asic/eecs151.bashrc
hammer-vlsi -h
echo $CALIBRE_HOME
cd Desktop/asic-labs-fa23-reindae/
git remote -v
git pull
git remote add https://github.com/EECS-151/asic_labs_fa23
git remote -v
git remote add starter https://github.com/EECS-151/asic_labs_fa23
git remote -v
git pull starter
git pull
git pull starter main
git fetch starter
git config pull.rebase false
git pull starter
git pull starter main
git remote -v
git pull starter
git checkout --ours lab1/
git add .
git commit -m "starting lab2"
git push
git config pull.rebase false
git pull starter main
git remote -v
git pull starter
git pull starter main
git pull starter main --allow-unrelated-histories
git checkout --ours lab1/
add .
git add .
git commit -m "starting lab 2"
git push origin main
git status
source /home/ff/eecs151/asic/eecs151.bashrc
hammer-vlsi -h
echo $CALIBRE_HOME
vim
~/.bashrc
vim ~/.bashrc
source /home/ff/eecs151/asic/eecs151.bashrc
make sim-rtl
cd lab2
make sim-rtl
cd build/
cd sim-rundir/
dve -vpd vcdplus.vpd &
vim
rm -rf ~/.local/share/nvim
vim
source /home/ff/eecs151/asic/eecs151.bashrc
ls
rm -rf ~/.local/share/nvim
vim
This site uses Just the Docs, a documentation theme for Jekyll.
Search EECS 151 ASIC Lab 2
Back to site
Simulation
This lab focuses on RTL simulation. RTL simulation is one of the first steps towards checking the baseline functionality of your design. Fixing bugs at the RTL design phase makes subsequent debugging much easier. The resources required and runtime is much lower than gate level simulation. To stress the flexibility of RTL simulation, we note that RTL simulation can be used to run unit tests to check a small block, as well as to simulate the behavior of a whole core running software, or more.
A natural conclusion, then, is that when working on complex designs, always seek to test smaller subcomponents early. Do not wait until the top-level design is complete before starting your tests.
For this lab, we will be using Verilog code that implements a very simple FIR (Finite Impulse Response) filter. A schematic of the filter is shown below.
There is an input signal and a clock input, and 5 delayed versions of the input are kept, multiplied by different coefficients, and then summed together. The expression for this particular filter is:
y[n] = 1 * x[n] + 4 * x[n − 1] + 16 * x[n − 2] + 4 * x[n − 3] + 1 * x[n − 4]
The input in our example is a 4 bit signed 2’s complement number, and the output is a larger bitwidth signed number to ensure that there is no overflow. The focus of this lab is not the filter design itself, but it serves as a useful example of a digital circuit to implement and test with Verilog code. Verilog code for this FIR filter is provided in the src folder.
Simulation Environment
We will be using Synopsys VCS as our Verilog simulator in this course. VCS works by compiling Verilog modules and generating a simulator binary file. You can then execute that binary file to produce the desired outputs. VCS is one of many Verilog simulators. Others include Cadence Xcelium (formerly Incisive) and the open source Verilator. The framework, mechanisms, and capabilities are quite similar between simulators.
Each CAD tool, including simulators, are highly configurable and can take in tens or hundreds (or more) configuration options. Invoking CAD tools manually and listing options and flags is unsustainable. Thus, regardless of whether you’re a student or an engineer at a big company, everyone has some kind of automated design flow. This can come in many forms, from a series of TCL files (Tool Control Language, which is the language of choice for ASIC CAD tools) that are pushed around by Makefiles, to more configurable and re-usable design frameworks.
In this course we will use an ASIC design framework developed here at Berkeley called Hammer. Hammer abstracts away tool- (Cadence, Synopsys, Mentor, etc.) and technology- (TSMC, Intel, etc.) specific considerations away from ASIC design. The philosophy of Hammer aims to maximize reusability of design intent between projects that may have differently underlying tool infrastructures and target different process technologies. Documentation about Hammer philosophy and usage is at hammer-vlsi.readthedocs.io.
For this lab, we will be ”implementing” our designs using the Skywater 130nm Process Design Kit. We have set up a bare-bones Hammer flow that you will see is largely shared between this lab and subsequent ones. You will execute steps within this flow by using a common Makefile. This flow is distilled from a Sky130 Tutorial contained in Chipyard, an open-source RISC-V SoC Design Framework also developed here at Berkeley. Chipyard documentation can be found here if are interested in learning more.
Hammer consumes serialized configuration files in YAML or JSON format, which are used as intermediate representation (IR) languages between higher-level physical design generators and the underlying scripts that the ASIC design flow tools require. In this lab repository, you will see a set of YAML files (inst-env.yaml, sky130.yml, design.yml, and a few sim-<type>.yml) that contain Hammer IR for our design implementation. Of these files, you will only interact with the sim-<type>.yml files to configure your simulation flow in this lab. The sources for this lab are contained in the src folder, and some special non-Verilog files will be explained later.
The Hammer source is installed in /home/ff/eecs151/fa23/hammer/. However, in the course of this class, it may begin to deviate from main Hammer. Please reference the public repository if you are interested in the latest, consistent source.
WARNING: Under no circumstance should Hammer plugins or commerical tool files be copied outside of the instructional machines. These have been provided solely for educational use. Failure to adhere to these guidelines can result in our academic community LOSING ACCESS to such resources.
To get started, examine the Makefile in the lab files. Skimming through, you can see that there are rules for the basic VLSI flow steps explored in these labs: simulation, power analysis, synthesis, place-and-route (PAR), design rule checking (DRC), layout vs. schematic (LVS), and translational steps between them. The top section of the Makefile defines variables that point to the YAML and JSON files needed by Hammer.
Next, examine the sim-rtl.yml file:
# RTL Simulation Variables
sim.inputs:
  input_files:
    - "src/fir.v"
    - "src/EECS151.v"
    - "src/addertree.v"
    - "src/fir_tb.v"
  timescale: "1ns/10ps"
  options:
    - "-notice"
    - "-line"
    - "+lint=all,noVCDE"
    - "+v2k"
    - "-debug"
    - "-sverilog"
  top_module: "fir"
  tb_name: "fir_tb"
  defines:
    - "CLOCK_PERIOD=1.00"
This is a snippet of Hammer IR in the sim namespace. These keys are consumed by Hammer to configure the simulation. Notice that the simulator needs some specifications, such as the files that contain our Verilog source code and our testbench name, some timescale on which to simulate and a clock period, and some options. These will be explained below. Exploring the other YAML files in this lab will give you an idea of what else is needed to define environment, tool, and technology constraints.
It’s not critical that you understand right now how Hammer works, but as you work through the ASIC labs, it may be interesting for you to think about why it may be useful and other methods of creating an ASIC flow design framework.
In Practice
Now, let’s decipher what happens under the hood when we run a simulation with Hammer. You can find the VCS user guides from the eecs151 class-account home directory for reference: /home/ff/eecs151/labs/manuals/vcsmx_ug.pdf, /home/ff/eecs151/labs/manuals/ucli_ug.pdf, and /home/ff/eecs151/labs/manuals/dve_ug.pdf.
To get started, let’s set up our environment. As a reminder, you will need to do this for every terminal session in which you use Hammer on the instructional machines. If you haven’t already, perform the following command.
cd Desktop/asic-labs-fa23-reindae/
ls
cd lab
cd lab2
cd build/sim-rundir
dve -vpd vcdplus.vpd &
source /home/ff/eecs151/asic/eecs151.bashrc
cd Desktop/asic-labs-fa23-reindae/cd lab2
cd Desktop/asic-labs-fa23-reindae/
cd lab2/build/
ls
cd sim-rundir
dve -vpd vcdplus.vpd &
ls
dve -vpd vcdplus.vpd &
source /home/ff/eecs151/asic/eecs151.bashrc
cd lab2
make sim-rtl
